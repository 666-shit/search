# 红黑树

时间复杂度对比：

|            | 查找        | 插入        | 删除        |
| ---------- | ----------- | ----------- | ----------- |
| BST        | O(n)        | O(n)        | O(n)        |
| 平衡二叉树 | O($log_2n$) | O($log_2n$) | O($log_2n$) |
| 红黑树     | O($log_2n$) | O($log_2n$) | O($log_2n$) |

平衡二叉树: 通过插入和删除操作容易破坏平衡性，需要计算平衡因子找到最小不平衡子树(时间开销大)
红黑树: 插入删除很多时候不会破坏红黑特性，无需频繁调整树的形态，调整可以再常数级时间内完成

**使用场景：**
平衡二叉树：适用于以查找为主，很少插入和删除
红黑树：适用于频繁插入删除，实用性更强也更多的使用

**考试：**
定义和性质(选择)
手绘插入(删除)过程，不考代码

**定义**
红黑树是二叉排序树，左<根<右
比普通BST的要求：

	1. 每个结点是红色或黑色的
	1. 根结点是黑色的
	1. 叶子结点(外部结点；null结点；失败结点)均是黑色的
	1. 不存在两个相邻的**红**结点(即红结点的父亲和孩子都是黑色)
	1. 对每个结点，从该结点到任一叶子结点的简单路径上，所含黑结点的数目相同

```c++
struct RBNode{
	int key;
	RBNode* parent;
	RBNode* lchild;
	RBNode* rchild;
	int color;		//结点颜色，可用“0/1”表示“黑/红”，也可以用enum表示
};
```

![image-20220921135657763](C:\Users\c1533\AppData\Roaming\Typora\typora-user-images\image-20220921135657763.png)

一棵红黑树
左根右，根叶黑，不红红，黑路同

黑高(bh)：
从某结点出发(不含该结点)到达任一空叶结点的路径上，黑结点总数

性质：

1.   从根结点到叶节点的最长路径不大于最短路径的两倍
2.   有n个内部结点的红黑树高度h<=$2log_2(n+1)$

查找：
与BST，AVL相同，从根出发，左小右大，若查到一个空叶结点，则查找失败

插入：

1.   先查找，确定插入位置(原理同二叉排序树)，插入新结点

2.   新结点是根——黑色；非根——红色(保证黑色路径长度相同)

     2.1 若插入新结点后依然满足红黑树，则插入结束

     2.2 若插入新结点后不满足红黑树(只需要检查红色结点是否相邻)，需要调整，使其满足红黑树定义

     ​	2.2.1 父结点的兄弟结点(叔结点)为黑色，则旋转+染色(染色不判断爷结点是否违反红黑树规则)

     ​		LL：右单旋，父换爷+染色
     ​		RR：左单旋，父换爷+染色
     ​		LR：左再右，儿换爷+染色
     ​		RL：右再左，儿换爷+染色

     ![image-20220923191539961](C:\Users\c1533\AppData\Roaming\Typora\typora-user-images\image-20220923191539961.png)

     ![image-20220923191856652](C:\Users\c1533\AppData\Roaming\Typora\typora-user-images\image-20220923191856652.png)

     ![image-20220923192130645](C:\Users\c1533\AppData\Roaming\Typora\typora-user-images\image-20220923192130645.png)

     ![image-20220923192256108](C:\Users\c1533\AppData\Roaming\Typora\typora-user-images\image-20220923192256108.png)

     ![image-20220923192408034](C:\Users\c1533\AppData\Roaming\Typora\typora-user-images\image-20220923192408034.png)

     ![image-20220923192626404](C:\Users\c1533\AppData\Roaming\Typora\typora-user-images\image-20220923192626404.png)

     ![image-20220923192851756](C:\Users\c1533\AppData\Roaming\Typora\typora-user-images\image-20220923192851756.png)

     ![image-20220923193636605](C:\Users\c1533\AppData\Roaming\Typora\typora-user-images\image-20220923193636605.png)

     ​	2.2.2 叔结点为红色，则染色(叔父爷都变色)+变新(爷结点变成新结点，看是爷变色后是否破坏平衡树)

**限制**：红黑树左右子树高度不超过两倍
使得插入后红黑特性不容易被破坏，插入和删除比平衡树更高效

黑高——从某点出发(不含该结点)到达任一叶结点的路径上黑结点总数
问：根结点黑高为h的红黑树，内部结点数至少(所有结点都是黑的且是满树)有多少个？
答：2^h - 1个

红黑树的**删除**：(不考)

1.   删除的时间复杂度：O($log_2n$)
2.   红黑树中删除结点的处理方式和二叉排序树的删除一样
3.   按第二步删除结点后，可能破坏红黑树特性，此时需要调整颜色和位置，使其再次满足红黑树特性

